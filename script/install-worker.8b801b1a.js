var e,t={375:(e,t,a)=>{var n,s,r,i,o=a(753);function c(e){let t=e?e.split(".").map(e=>parseInt(e)):[];for(;t.length<4;)t.push(0);return t.length=4,t}function l(){return Date.now().toString()}function u(e){return e.getTime()}function p(e){let t=e.lastIndexOf(".");return t>0?e.substring(t+1):""}function d(e){const t=e.lastIndexOf(".");return t<0||t<e.lastIndexOf("/")?e:e.substring(0,t)}function f(e){let t="";if(e instanceof Event)if(e.target instanceof IDBOpenDBRequest){const t=e.target;t.error&&(e=t.error)}else e.message&&(t=e.message);else if(e instanceof Error){const a=e;t=a.name,t.endsWith(".")||(t+="."),a.message&&(t+=" "+a.message)}else if(e instanceof Response){const n=e;t=a(`Response: ok=${n.ok}; status=${n.status}; statusText=${n.statusText}; type=${n.type}; url=${n.url}.`)}else"string"==typeof e?t=e:(e&&e.name&&(t=a(e.name)),e&&e.status&&(t=a(`status=${e.status}`)),e&&e.statusText&&(t=a(`statusText=${e.statusText}`)));return t;function a(e){return t.length>0?t+=` | ${e}`:e}}new Map([["css","text/css"],["js","application/x-javascript"],["json","application/json"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["ico","image/x-icon"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["png","image/png"],["svg","image/svg+xml"],["bmp","image/bmp"],["mp3","audio/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["wma","audio/x-ms-wma"],["wav","audio/wav"]]),function(e){e[e.Local=0]="Local",e[e.Storage=1]="Storage",e[e.Service=2]="Service",e[e.Link=3]="Link"}(n||(n={})),function(e){e[e.None=0]="None",e[e.CssUrl=1]="CssUrl"}(s||(s={})),function(e){e[e.Classic=0]="Classic",e[e.Regular=1]="Regular",e[e.VMBook=2]="VMBook"}(r||(r={})),function(e){e[e.Undef=0]="Undef",e[e.Start=1]="Start",e[e.Download=2]="Download",e[e.Parsing=3]="Parsing",e[e.Integration=4]="Integration",e[e.Finish=5]="Finish",e[e.Error=6]="Error"}(i||(i={}));let h=0,m=null;function g(e){return new Promise((t,a)=>{e.onsuccess=a=>{a.target instanceof IDBRequest?(e=a.target,t(e.result)):t(void 0)},e.onerror=e=>{a(e)}})}function b(e){return e.patchVersion?`${e.majorVersion}.${e.minorVersion}.${e.patchVersion}`:`${e.majorVersion}.${e.minorVersion}`}function w(e){return`${e.machineName}-${e.majorVersion}.${e.minorVersion}`}class k{id;origId;name;version;isPopup;packtype;sourceType;suiteid;filename;filesize;modified;isBroken;constructor(e){this.id=e.id,this.origId=e.origId,this.name=e.name,this.version=e.version,this.isPopup=e.isPopup,this.packtype=e.packtype||r.Classic,this.sourceType=e.sourceType,this.suiteid=e.suiteid,this.filename=e.fileinfo.fullname,this.filesize=e.fileinfo.size,this.modified=e.fileinfo.modified,this.isBroken=e.isBroken}}class y{_fileinfo;_internals;_objPackage;_outerBook;_isCorrect=!1;_strIncorrectMessage="";extractId(e){if(!e)return null;const t=e.match(/(?<=id=\s*)(\S+)(?=\s*;)/im);return t&&t.length>0?t[0]:null}extractIsPopup(e){if(!e)return!1;const t=e.match(/(?<=popup=\s*)(\S+)(?=\s*;)/im);return!!(t&&t.length>0)&&"true"===t[0].toLowerCase()}extractVersion(e){if(Array.isArray(e)){const t=e[e.length-1];if("string"==typeof t.log)return t.log.match(/(?<=@version=\s*)(\S+)(?=\s*;)/im)[0]||null}return null}constructor(e,t,a){this._fileinfo=e,this._internals=t;const s=t.metadata.preloadedDependencies.find(e=>e.machineName===t.metadata.mainLibrary);if(!s)throw new Error(`PackageRaw ctor: The Main Library Object for the ${t.metadata.mainLibrary} was not found!`);const i=w(s);if(this._objPackage={id:void 0,origId:void 0,name:t.metadata.title,version:"0.0.0",isPopup:!1,packtype:r.Classic,sourceType:a.sourceType,distorId:a?.distorId||"",sourceUrl:a.sourceUrl||"",suiteid:"",fileinfo:e,installed:Date.now(),updated:0,libtoken:i,metadata:t.metadata,dependencies:[],isBroken:!1,brokeninfo:""},this._outerBook=a,a.sourceType===n.Service)this._objPackage.id=this._outerBook.id,this._objPackage.version=this._outerBook.version,this._objPackage.packtype=r.Regular;else{let e=this.extractId(this._objPackage.metadata.authorComments);e?(this._objPackage.id=e,this._objPackage.version=this.extractVersion(this._objPackage.metadata.changes)||this._objPackage.version,this._objPackage.packtype=r.Regular):this._objPackage.id="h5p-"+l()}this._objPackage.isPopup=this.extractIsPopup(this._objPackage.metadata.authorComments),this._objPackage.fileinfo.modified=u(new Date),this._objPackage.origId=this._objPackage.id,this._internals.content.packId=this._objPackage.id;const o=t.metadata.preloadedDependencies;if(Array.isArray(o))for(let e=0;e<o.length;e++){let t=w(o[e]);this._objPackage.dependencies.push(t)}this._isCorrect=!0}get isCorrect(){return this._isCorrect}get isClassic(){return this._objPackage.packtype===r.Classic}get incorrectMessage(){return this._strIncorrectMessage}get fileinfo(){return this._fileinfo}get newlibs(){return this._internals.newlibs}get content(){return this._internals.content}get stored(){return this._objPackage}get overview(){return this._outerBook?.overview||""}get thumbnail(){return this._outerBook?.thumbnail||""}get cover(){return this._outerBook?.cover||""}makeUniqueName(){const e=(new Date).toLocaleString();this._objPackage.name=`${this._objPackage.name} (${e})`}changeId(e){this._objPackage.id=e,this._objPackage.packtype===r.Classic&&(this._objPackage.origId=e)}setUpdatedTimestamp(e){this._objPackage.updated=e}getCase(){return new k(this._objPackage)}}class _{static _totalSteps;static _countSteps;static _progress;static _prev;static _percVal;static _cbProgress;static reset(e,t){this._cbProgress=t,this._totalSteps=e,this._countSteps=0,this._progress=0,this._prev=0,this._percVal=100/this._totalSteps}static step(e=1){this._countSteps+=e,this._countSteps>this._totalSteps&&(this._countSteps=this._totalSteps),this._progress=this._countSteps*this._percVal,this._progress-this._prev>=1&&(this._prev=this._progress,this._cbProgress(Math.round(this._progress)))}static complete(){this.step(this._totalSteps-this._countSteps)}}var v,P;!function(e){e[e.Undef=0]="Undef",e[e.Ignore=1]="Ignore",e[e.Directory=2]="Directory",e[e.RootFile=3]="RootFile",e[e.ContentPart=4]="ContentPart",e[e.LibraryPart=5]="LibraryPart"}(v||(v={})),function(e){e[e.None=0]="None",e[e.CssUrl=1]="CssUrl"}(P||(P={}));class j{static PackageMain="h5p.json";static ContentFolder="content";static ContentEntry="content/content.json";static ContentFile="content.json";static LibraryFile="library.json";static UpgradesFile="upgrades.js";static PresaveFile="presave.js";static EditorLibPrefix="H5PEditor"}const S=new Set([j.PackageMain]);let x,C,D,I,T,O,V,E=i.Undef,$=null;async function U(){$=await(h++,new Promise((e,t)=>{if(m)e(m);else{let a=indexedDB.open("AppDB",1);a.onerror=e=>{let a=f(e);t(new Error("AppDB Error: "+a))},a.onblocked=e=>{t(new Error("AppDB Failure: The application database is blocked"))},a.onsuccess=t=>{let a=t.target;m=a.result,e(m)},a.onupgradeneeded=e=>{!function(e){let t=e.target.result;e.oldVersion<3&&(function(){const e=t.objectStoreNames;for(let a=0;a<e.length;a++)t.deleteObjectStore(e[a])}(),function(){t.createObjectStore("_system"),t.createObjectStore("shared"),t.createObjectStore("users"),t.createObjectStore("shelves"),t.createObjectStore("stuffs"),t.createObjectStore("results"),t.createObjectStore("suites"),t.createObjectStore("packs"),t.createObjectStore("packcont"),t.createObjectStore("packext");const e=t.createObjectStore("wincache");e.createIndex("user_idx","userId"),e.createIndex("pack_idx","packId"),t.createObjectStore("libs"),t.createObjectStore("libfiles")}())}(e)}}}))}class F{static checkCssUrl(e){return e.indexOf("url(")>=0}static setDataContent(e,t){var a;t.data=(a=e,(new TextEncoder).encode(a)),t.text=null,t.preproc=P.None}static setTextContent(e,t,a){t.data=null,t.text=e,t.preproc=a}static adaptH5P_InteractiveBook(e,t){switch(t.extension){case"css":this.checkCssUrl(e)?this.setTextContent(e,t,P.CssUrl):this.setDataContent(e,t);break;case"js":"h5p-interactive-book"===t.name&&(e=e.replace("addHashListener(top)","addHashListener(window)")),this.setDataContent(e,t);break;default:this.setDataContent(e,t)}}static adaptH5P_SingleChoiceSet(e,t,a){if("sound-effects"===t.name){const n=`SoundEffects.types.forEach(async function (type) { const player = new Audio(); const extension = player.canPlayType('audio/ogg') ? 'ogg' : 'mp3'; const lib = window.parent.ActivePackage.getActiveLibrary("${a.token}"); if (lib) { const data = lib.getObjectURLFlex(type + '.' + extension); if (data) { player.src = data; players[type] = player; } } });`,s=/SoundEffects\.types\.forEach(.[\s\S]+?)}\);/g;e=e.replace(s,n),this.setDataContent(e,t)}else this.setDataContent(e,t)}static adaptH5P_SoundJS(e,t){t.name.startsWith("soundjs")&&"js"===t.extension?(e='class SoundJS_Proxy{_mapSounds=new Map;constructor(){}initializeDefaultPlugins(){return!0}registerSound(e,t){let n=window.parent.ActivePackage;if(n){let i=e.indexOf("/");if(i>0){let s=e.substring(0,i);e=e.substring(i+1);let r=n.getActiveLibrary(s);if(r){let u=r.getObjectURL(e);u&&this._mapSounds.set(t,new Audio(u))}}}}get INTERRUPT_NONE(){return"none"}play(e,t,n){let i=this._mapSounds.get(e);i&&(n>0?setTimeout(e=>{e.play()},n,i):i.play())}}window.H5P.SoundJS=new SoundJS_Proxy;',this.setDataContent(e,t)):this.setDataContent(e,t)}static processCodeLibFile(e,t,a){switch(!0){case a.token.startsWith("H5P.InteractiveBook"):this.adaptH5P_InteractiveBook(e,t);break;case a.token.startsWith("H5P.SingleChoiceSet"):this.adaptH5P_SingleChoiceSet(e,t,a);break;case a.token.startsWith("H5P.SoundJS"):this.adaptH5P_SoundJS(e,t);break;default:"css"===t.extension&&this.checkCssUrl(e)?this.setTextContent(e,t,P.CssUrl):this.setDataContent(e,t)}}}async function B(e){const t=new o.rd;return await e.getData(t),await t.getData()}async function L(e){const t=new o.rd;await e.getData(t);const a=await t.getData();return JSON.parse(a)}async function A(e,t=void 0){async function a(e,t){var a=new o.$i;await e.entry.getData(a),t.data=await a.getData(),t.text=null}const n={name:e.name,extension:e.extension,path:e.localpath,preproc:P.None};switch(e.status){case v.ContentPart:await a(e,n);break;case v.LibraryPart:if(1==(("css"===e.extension||"js"===e.extension)&&!!t)){var s=new o.rd;await e.entry.getData(s);const a=await s.getData();F.processCodeLibFile(a,n,t)}else await a(e,n)}return n}async function N(e,t){const a={preproc:P.None};a.path=e+"/"+t.filename,a.extension=p(t.filename);var n=new o.$i;return await t.getData(n),a.data=await n.getData(),a.text=null,a}function M(e){function t(e){const t=e.lastIndexOf(".");return t<=0||t===e.length-1?["",""]:[e.substring(0,t),e.substring(t+1)]}const a={status:v.Undef,entry:e};if(e.directory)a.status=v.Directory,a.localpath=a.filename;else{const n=e.filename.split("/");if(0!==n.length)if(1==n.length){if(a.filename=n[0],a.localpath=a.filename,S.has(a.filename)){const e=t(a.filename);a.name=e[0],a.extension=e[1],a.rootParent="",a.status=v.RootFile}}else{a.filename=n[n.length-1],a.localpath=n.slice(1).join("/");const e=t(a.filename);e[0].length>0&&(a.name=e[0],a.extension=e[1],a.rootParent=n[0],a.rootParent==j.ContentFolder?a.status=a.filename==j.ContentFile?v.Ignore:v.ContentPart:a.status=a.rootParent.startsWith(j.EditorLibPrefix)?v.Ignore:v.LibraryPart)}}return a}async function R(e){return new Promise(async(t,a)=>{try{let a=$.transaction("packs","readonly").objectStore("packs"),n=null,s=!1;a.openCursor().onsuccess=a=>{const i=a.target.result;if(i){const a=i.value;a.packtype===r.Classic?e.fileinfo.fullname===a.fileinfo.fullname&&(n=a,s=e.fileinfo.size===a.fileinfo.size&&e.fileinfo.modified===a.fileinfo.modified):e.id===a.id&&(n=a,s=function(e,t){const a=c(e),n=c(t);for(let e=0;e<2;e++)if(a[e]!==n[e])return!1;return!0}(e.version,a.version)),n?t({pack:n,match:s}):i.continue()}else t({pack:null,match:!1})}}catch(e){a(e)}})}function z(e){self.postMessage({phase:E,percent:e})}async function H(e,t){const a={metadata:{title:"",extraTitle:"",mainLibrary:"",language:"",defaultLanguage:"",embedTypes:[],license:"",licenseExtras:"",preloadedDependencies:[],changes:[],authors:[],authorComments:""},content:{packId:"",data:"",files:[],iv:void 0},newlibs:new Map},n=new o.nZ(e),s=new o.zg(n),r=await s.getEntries(),i=r.find(e=>e.filename&&e.filename.startsWith(j.ContentEntry));if(!i)throw new Error('The "content.json" file was not found in the package!');let c;const l=i.filename.substring(j.ContentEntry.length);if(l.length>0){const e=function(e){for(var t=atob(e),a=new Uint8Array(t.length),n=0;n<t.length;n++)a[n]=t.charCodeAt(n);return a.buffer}(l.split(".",1)[0].replace("_","//"));let t=await async function(e){const t=new o.$i;return await e.getData(t),await t.getData()}(i);try{const n=await async function(e,t,a){if(!a)throw new Error("The decryption key is missing!");const n={name:"AES-CBC",iv:e};return await crypto.subtle.decrypt(n,a,t)}(e,t.buffer,D);a.content.data=t.buffer,a.content.iv=e,c=(new TextDecoder).decode(n)}catch(e){let t=f(e);console.error(t)}}c||(c=await B(i),a.content.data=c);const u=new Map;!function(e,t){function a(e){const a=JSON.parse(e),n=a.vmbraw;n.path?t.set(n.path,a):console.error('CyberShelf Parser: Incorrect "wmbraw " format!')}let n=e.indexOf('"vmbraw"'),s=n;for(;s>0;){let t=!1,r=0,i=0,o="",c="";for(let l=s;l<e.length;l++){switch(c=o,o=e[l],o){case'"':"\\"!==c&&(t=!t);break;case"{":t||r++;break;case"}":t||i++}if(i>0&&r===i){s=l+1,a("{"+e.substring(n,s)+"}");break}}n=e.indexOf('"vmbraw"',s),s=n}}(c,u),_.reset(r.length,t);for(let e=0;e<r.length;e++){_.step();const t=r[e],n=M(t);switch(n.status){case v.RootFile:n.filename==j.PackageMain?a.metadata=await L(n.entry):console.error(`Unknown entry in the root of the H5P package (entry: "${t.filename}"), (package file: "${I}").`);break;case v.ContentPart:if(u.has(n.localpath))u.set(n.localpath,n.entry);else{const e=await A(n);a.content.files.push(e)}break;case v.LibraryPart:{const e=n.rootParent;let t=a.newlibs.get(e);t||(t={token:e,files:[]},a.newlibs.set(e,t));const s=await A(n,t);switch(t.files.push(s),n.filename){case j.LibraryFile:{const e=await B(n.entry);t.metadata=JSON.parse(e),t.machineName=t.metadata.machineName,t.majorVersion=t.metadata.majorVersion,t.minorVersion=t.metadata.minorVersion,t.version=b(t.metadata),t.metadata.coreApi&&(t.majorVersionCore=t.metadata.coreApi.majorVersion,t.minorVersionCore=t.metadata.coreApi.minorVersion),t.isAddon=!!t.metadata.addTo;break}case j.UpgradesFile:t.textUpgrades=await B(n.entry);break;case j.PresaveFile:t.textPresave=await B(n.entry)}break}case v.Ignore:case v.Directory:break;case v.Undef:console.error(`Unrecognized entry status (entry: "${t.filename}"), (package file: "${I}").`)}}a.newlibs=await async function(e){const t=await async function(e,t){let a;try{let n=e.transaction(t,"readonly").objectStore(t);a=await g(n.getAll())}finally{return a||[]}}($,"libs");return new Map([...e.entries()].filter(([e,a])=>{const n=t.find(t=>t.token===e);return!n||function(e,t){const a=Number(e.metadata.patchVersion),n=Number(t.metadata.patchVersion);return!0===Number.isInteger(n)&&(!Number.isInteger(a)||n>a)}(n,a)}))}(a.newlibs),_.complete(),u.size>0&&_.reset(u.size,t);for(let e of u.entries()){if(_.step(),"function"!=typeof e[1].getData)throw new Error(`Incorrect format of the Raw VMB content file "${e[0]}": The corresponding Zip was not found!`);{var p=new o.$i;const t=await e[1].getData(p),n=new Blob([t]),s=new o.nZ(n),r=new o.zg(s),i=await r.getEntries();for(let t=0;t<i.length;t++){const n=i[t];if(n.directory)continue;const s=await N(d(e[0]),n);a.content.files.push(s)}}}return _.complete(),await s.close(),a}async function J(e,t){const a=e.transaction(["_system"],"readwrite");a.onerror=e=>{const t=`install-worker.ts/regAddons: An unhandled transaction error has occurred: ${f(e)}`;console.error(t)};const n=a.objectStore("_system"),s=await g(n.get("addons"))||{};let r=!1;t.forEach(e=>{if(e.isAddon){const t=s[e.machineName];(!t||t&&function(e,t){const a=c(e),n=c(t);for(let e=0;e<4;e++)if(a[e]!==n[e])return a[e]<n[e]?-1:1;return 0}(e.version,t.version)>=0)&&(r=!0,s[e.machineName]={machineName:e.machineName,majorVersion:e.majorVersion,minorVersion:e.minorVersion,token:e.token,version:e.version,addTo:e.metadata.addTo})}}),r&&await g(n.put(s,"addons"))}self.onmessage=async function(e){try{const t=e.data;switch(t.params&&(x=t.params),!0){case void 0!==t.bookRef:C=x.apiKey,D=t.cryptoKey,I=t.bookRef.label,await U(),await async function(e){E=i.Download;const t=e.source instanceof File?await async function(e){try{const t=await e.arrayBuffer();return new Blob([t],{type:e.type})}catch(e){throw new Error("Error converting File to Blob. "+f(e))}}(e.source):await async function(e,t){const a=C&&C.length>0?{method:"GET",mode:"cors",headers:{"Content-Type":"application/octet-stream",Authorization:C}}:{method:"GET",mode:"cors",headers:{"Content-Type":"application/octet-stream"}},n=await fetch(e,a);if(!n.ok)throw new Error(`The "${e}" file upload failed: status=${n.status}, text="${n.text}", type=${n.type}.`);const s=Number(n.headers.get("Content-Length"));let r=0,i=[];const o=n.body.getReader();for(_.reset(s,t);;){const{value:e,done:t}=await o.read();if(t)break;i.push(e),r+=e.length,_.step(e.length)}let c=new Uint8Array(r),l=0;for(let e of i)c.set(e,l),l+=e.length;return _.complete(),new Blob([c])}(e.source,z);E=i.Parsing,T=await H(t,z),E=i.Integration;const a={fullname:e.source instanceof File?e.source.name:e.source,name:e.source instanceof File?d(e.source.name):e.label,extension:e.source instanceof File?p(e.source.name):"",size:e.source instanceof File?e.source.size:t.size,modified:e.source instanceof File?e.source.lastModified:u(new Date)};V=new y(a,T,e),e.source instanceof File?(O=await R(V.stored),O.pack?self.postMessage({candidate:V.getCase(),existing:new k(O.pack),match:O.match}):self.postMessage({candidate:V.getCase()})):(!0===x.isUpdate&&(O=await R(V.stored)),self.postMessage({candidate:V.getCase()}))}(t.bookRef);break;case void 0!==t.setupVariant:await U(),await async function(e){switch(e){case"install":if(O&&O.pack){if(!V)throw new Error('completeSetup/install: The value of "_packRaw" is undefined!');V.makeUniqueName(),V.isClassic||V.changeId("tmp-"+l())}break;case"update":if(!V||!O)throw new Error('completeSetup/update: The value of "_packRaw" or "_existBookInfo" is undefined!');V.isClassic&&V.changeId(O.pack.id),V.setUpdatedTimestamp(Date.now())}const t=await async function(e,t,a){return new Promise(async(n,s)=>{let r=null;try{r=e.transaction(["libs","libfiles","packs","packext","packcont"],"readwrite"),r.oncomplete=e=>{n(t.getCase())},r.onerror=e=>{r=null,s("(Setup) AppDB Transaction error. "+f(e))},_.reset(5,a);for(const[e,a]of t.newlibs){const t=a.files;delete a.files;let n=r.objectStore("libs");await g(n.put(a,e));const s={libtoken:e,files:t};let i=r.objectStore("libfiles");await g(i.put(s,e))}_.step();let i=r.objectStore("packs");await g(i.put(t.stored,t.stored.id)),_.step();let o=r.objectStore("packext");await g(o.put({packId:t.stored.id,thumbnail:t.thumbnail,cover:t.cover,overview:t.overview},t.stored.id)),_.step();let c=r.objectStore("packcont");await g(c.put(t.content,t.stored.id)),_.step(),await J(e,[...t.newlibs.values()]),_.step(),_.complete()}catch(e){s(e)}})}($,V,z);self.postMessage({phase:i.Finish,bookCase:t,newLibs:T.newlibs})}(t.setupVariant);break;case void 0!==t.libFile:await U(),await async function(e){const t=await async function(e){const t={},a=[],n=new o.nZ(e),s=new o.zg(n),r=await s.getEntries();for(let e=0;e<r.length;e++){const n=M(r[e]);switch(n.status){case v.LibraryPart:{const e=await A(n);switch(a.push(e),n.filename){case j.LibraryFile:{if(t.token)throw new Error("Incorrect structure of the H5P library file. More than one nested directory was found!");t.token=n.rootParent;const e=await B(n.entry);t.metadata=JSON.parse(e),t.machineName=t.metadata.machineName,t.majorVersion=t.metadata.majorVersion,t.minorVersion=t.metadata.minorVersion,t.version=b(t.metadata),t.metadata.coreApi&&(t.majorVersionCore=t.metadata.coreApi.majorVersion,t.minorVersionCore=t.metadata.coreApi.minorVersion),t.isAddon=!!t.metadata.addTo;break}case j.UpgradesFile:t.textUpgrades=await B(n.entry);break;case j.PresaveFile:t.textPresave=await B(n.entry)}break}}}return await s.close(),{library:t,files:{libtoken:t.token,files:a}}}(e);if(!t.library||!t.library.token)throw new Error(`The file "${e.name}" contains an incorrect H5P library format!`);const a=$.transaction(["libs","libfiles"],"readwrite");a.onerror=e=>{const t=`install-worker.ts/installLibrary: An unhandled transaction error has occurred: ${f(e)}`;console.error(t)};let n=a.objectStore("libs"),s=a.objectStore("libfiles");await g(n.put(t.library,t.library.token));const r={libtoken:t.library.token,files:t.files.files};await g(s.put(r,t.library.token)),await J($,[t.library]);const i={key:t.library.token,title:t.library.metadata.title,version:t.library.version};self.postMessage({libBrief:i})}(t.libFile)}}catch(e){self.postMessage({phase:i.Error,message:f(e)})}finally{$&&(h--,h<1&&(h=0,m&&(m.close(),m=null))),$=null}}}},a={};function n(e){var s=a[e];if(void 0!==s)return s.exports;var r=a[e]={exports:{}};return t[e](r,r.exports,n),r.exports}n.m=t,e=[],n.O=(t,a,s,r)=>{if(!a){var i=1/0;for(u=0;u<e.length;u++){for(var[a,s,r]=e[u],o=!0,c=0;c<a.length;c++)(!1&r||i>=r)&&Object.keys(n.O).every(e=>n.O[e](a[c]))?a.splice(c--,1):(o=!1,r<i&&(i=r));if(o){e.splice(u--,1);var l=s();void 0!==l&&(t=l)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[a,s,r]},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var s,r=n;export{r as __webpack_require__};s={303:0},n.C=e=>{var t,a,{__webpack_esm_ids__:r,__webpack_esm_modules__:i,__webpack_esm_runtime__:o}=e,c=0;for(t in i)n.o(i,t)&&(n.m[t]=i[t]);for(o&&o(n);c<r.length;c++)a=r[c],n.o(s,a)&&s[a]&&s[a][0](),s[r[c]]=0;n.O()},n.O.j=e=>0===s[e];import*as i from"./zip.09c059d7.js";n.C(i);var o=n.O(void 0,[708],()=>n(375));o=n.O(o);